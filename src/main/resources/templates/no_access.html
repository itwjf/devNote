<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="zh">
<head>
  <meta charset="UTF-8">
  <title>æ— æƒæŸ¥çœ‹ - DevNote</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <style>
    .site-header {
      background: linear-gradient(135deg, #0d6efd, #0b5ed7);
    }
    .header-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      object-fit: cover;
    }
    .access-card {
      max-width: 600px;
      margin: 2rem auto;
      padding: 2.5rem;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      background: white;
      text-align: center;
    }
    .icon-lock {
      font-size: 3rem;
      color: #6c757d;
      margin-bottom: 1.5rem;
    }
    .visibility-badge {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.9rem;
      font-weight: 600;
      margin-top: 0.5rem;
    }
    .badge-public { background-color: #d4edda; color: #155724; }
    .badge-followers { background-color: #fff3cd; color: #856404; }
    .badge-private { background-color: #f8d7da; color: #721c24; }
  </style>
</head>
<body class="bg-light">

<!-- ========== å¯¼èˆªæ  ========== -->
<header class="site-header text-white py-2">
  <div class="container-fluid px-4">
    <nav class="navbar navbar-expand-lg navbar-dark">
      <a class="navbar-brand fs-4 fw-bold" th:href="@{/}">DevNote</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="mainNavbar">
        <ul class="navbar-nav ms-auto align-items-center">
          <li class="nav-item mx-2"><a class="nav-link" th:href="@{/}">é¦–é¡µ</a></li>
          <li class="nav-item mx-2"><a class="nav-link" th:href="@{/posts}">æ–‡ç« </a></li>
          <li class="nav-item mx-2"><a class="nav-link" th:href="@{/posts/new}">å†™æ–‡ç« </a></li>

          <li class="nav-item ms-lg-4 d-flex align-items-center gap-2">
            <img src="/images/default-avatar.png" alt="avatar" class="header-avatar"
                 th:if="${currentUsername != null}"
                 th:src="${currentUserAvatar != null ? currentUserAvatar : '/images/default-avatar.png'}">
            <span th:text="${currentUsername != null ? currentUsername : 'æ¸¸å®¢'}"></span>
          </li>
        </ul>
      </div>
    </nav>
  </div>
</header>

<!-- ========== ä¸»å†…å®¹åŒº ========== -->
<main class="py-4">
  <div class="container">
    <div class="access-card">
      <div class="icon-lock">
        <i class="bi bi-lock"></i>
      </div>
      <h2 class="mb-3">ğŸ”’ æ— æƒæŸ¥çœ‹æ­¤æ–‡ç« </h2>

      <p class="text-muted mb-3">
        ä½œè€…ï¼š<strong th:text="${post.author.username}">ä½œè€…</strong>
      </p>

      <p class="mb-3">
        å½“å‰æ–‡ç« å¯è§æ€§ï¼š
        <span th:switch="${post.visibility}" class="visibility-badge"
              th:classappend="|${#strings.equals(post.visibility, 'PUBLIC') ? 'badge-public' :
                               #strings.equals(post.visibility, 'FOLLOWERS') ? 'badge-followers' :
                               #strings.equals(post.visibility, 'PRIVATE') ? 'badge-private' : ''}|">
          <span th:case="'PUBLIC'">å…¬å¼€</span>
          <span th:case="'FOLLOWERS'">ç²‰ä¸å¯è§</span>
          <span th:case="'PRIVATE'">ä»…ä½œè€…</span>
          <span th:case="*">æœªçŸ¥</span>
        </span>
      </p>

      <!-- ç™»å½•çŠ¶æ€åˆ¤æ–­ -->
      <div th:if="${#authorization.expression('isAuthenticated()')}">
        <p class="text-muted">
          ä½ å·²ç™»å½•ï¼Œä½†å°šæœªæ»¡è¶³è®¿é—®æ¡ä»¶ï¼ˆä¾‹å¦‚æœªå…³æ³¨ä½œè€…ï¼‰ã€‚
        </p>
      </div>
      <div th:if="${!#authorization.expression('isAuthenticated()')}">
        <p class="text-muted">
          è¯·å…ˆ <a th:href="@{/login}" class="text-primary text-decoration-none">ç™»å½•</a>ï¼Œ
          ä»¥æ£€æŸ¥æ˜¯å¦å…·å¤‡è®¿é—®æƒé™ã€‚
        </p>
      </div>

      <div class="mt-4">
        <a th:href="@{/}" class="btn btn-outline-primary">â† è¿”å›é¦–é¡µ</a>
      </div>
    </div>
  </div>
</main>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>